<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Orthogonalizing EM — oem • oem</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Orthogonalizing EM — oem" />
<meta property="og:description" content="Orthogonalizing EM" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oem</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/oem_vignette.html">Usage of the oem Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jaredhuling/oem">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Orthogonalizing EM</h1>
    <small class="dont-index">Source: <a href='https://github.com/jaredhuling/oem/blob/master/R/oem.R'><code>R/oem.R</code></a></small>
    <div class="hidden name"><code>oem.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Orthogonalizing EM</p>
    </div>

    <pre class="usage"><span class='fu'>oem</span>(
  <span class='no'>x</span>,
  <span class='no'>y</span>,
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"gaussian"</span>, <span class='st'>"binomial"</span>),
  <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"elastic.net"</span>, <span class='st'>"lasso"</span>, <span class='st'>"ols"</span>, <span class='st'>"mcp"</span>, <span class='st'>"scad"</span>, <span class='st'>"mcp.net"</span>, <span class='st'>"scad.net"</span>,
    <span class='st'>"grp.lasso"</span>, <span class='st'>"grp.lasso.net"</span>, <span class='st'>"grp.mcp"</span>, <span class='st'>"grp.scad"</span>, <span class='st'>"grp.mcp.net"</span>, <span class='st'>"grp.scad.net"</span>,
    <span class='st'>"sparse.grp.lasso"</span>),
  <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(<span class='fl'>0</span>),
  <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(<span class='fl'>0</span>),
  <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>100L</span>,
  <span class='kw'>lambda.min.ratio</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>gamma</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>tau</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(<span class='fl'>0</span>),
  <span class='kw'>penalty.factor</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>group.weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>500L</span>,
  <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-07</span>,
  <span class='kw'>irls.maxit</span> <span class='kw'>=</span> <span class='fl'>100L</span>,
  <span class='kw'>irls.tol</span> <span class='kw'>=</span> <span class='fl'>0.001</span>,
  <span class='kw'>accelerate</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>ncores</span> <span class='kw'>=</span> -<span class='fl'>1</span>,
  <span class='kw'>compute.loss</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>hessian.type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"upper.bound"</span>, <span class='st'>"full"</span>)
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>input matrix of dimension n x p or <code>CsparseMatrix</code> object of the <span class="pkg">Matrix</span> package. 
Each row is an observation, each column corresponds to a covariate. The oem() function
is optimized for n &gt;&gt; p settings and may be very slow when p &gt; n, so please use other packages
such as <code>glmnet</code>, <code>ncvreg</code>, <code>grpreg</code>, or <code>gglasso</code> when p &gt; n or p approx n.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>numeric response vector of length <code>nobs</code>.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p><code>"gaussian"</code> for least squares problems, <code>"binomial"</code> for binary response.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p>Specification of penalty type. Choices include:</p><ul>
<li><p><code>"elastic.net"</code> - elastic net penalty, extra parameters: <code>"alpha"</code></p></li>
<li><p><code>"lasso"</code> - lasso penalty</p></li>
<li><p><code>"ols"</code> - ordinary least squares</p></li>
<li><p><code>"mcp"</code> - minimax concave penalty, extra parameters: <code>"gamma"</code></p></li>
<li><p><code>"scad"</code> - smoothly clipped absolute deviation, extra parameters: <code>"gamma"</code></p></li>
<li><p><code>"mcp.net"</code> - minimax concave penalty + l2 penalty, extra parameters: 
   <code>"gamma"</code>, <code>"alpha"</code></p></li>
<li><p><code>"scad.net"</code> - smoothly clipped absolute deviation + l2 penalty, extra parameters: 
   <code>"gamma"</code>, <code>"alpha"</code></p></li>
<li><p><code>"grp.lasso"</code> - group lasso penalty</p></li>
<li><p><code>"grp.lasso.net"</code> - group lasso penalty + l2 penalty, extra parameters: <code>"alpha"</code></p></li>
<li><p><code>"grp.mcp"</code> - group minimax concave penalty, extra parameters: <code>"gamma"</code></p></li>
<li><p><code>"grp.scad"</code> - group smoothly clipped absolute deviation, extra parameters: <code>"gamma"</code></p></li>
<li><p><code>"grp.mcp.net"</code> - group minimax concave penalty + l2 penalty, extra parameters: <code>"gamma"</code>, <code>"alpha"</code></p></li>
<li><p><code>"grp.scad.net"</code> - group smoothly clipped absolute deviation + l2 penalty, extra parameters: <code>"gamma"</code>, <code>"alpha"</code></p></li>
<li><p><code>"sparse.grp.lasso"</code> - sparse group lasso penalty (group lasso + lasso), extra parameters: <code>"tau"</code></p></li>
</ul><p>Careful consideration is required for the group lasso, group MCP, and group SCAD penalties. Groups as specified by the <code>groups</code> argument 
should be chosen in a sensible manner.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>observation weights. Not implemented yet. Defaults to 1 for each observation (setting weight vector to 
length 0 will default all weights to 1)</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A user supplied lambda sequence. By default, the program computes
its own lambda sequence based on <code>nlambda</code> and <code>lambda.min.ratio</code>. Supplying
a value of lambda overrides this.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>The number of lambda values. The default is 100.</p></td>
    </tr>
    <tr>
      <th>lambda.min.ratio</th>
      <td><p>Smallest value for lambda, as a fraction of <code>lambda.max</code>, the (data derived) entry
value (i.e. the smallest value for which all coefficients are zero). The default
depends on the sample size nobs relative to the number of variables nvars. If
<code>nobs &gt; nvars</code>, the default is 0.0001, close to zero. If <code>nobs &lt; nvars</code>, the default
is 0.01. A very small value of <code>lambda.min.ratio</code> will lead to a saturated fit
when <code>nobs &lt; nvars</code>.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>mixing value for <code>elastic.net</code>, <code>mcp.net</code>, <code>scad.net</code>, <code>grp.mcp.net</code>, <code>grp.scad.net</code>. 
penalty applied is (1 - alpha) * (ridge penalty) + alpha * (lasso/mcp/mcp/grp.lasso penalty)</p></td>
    </tr>
    <tr>
      <th>gamma</th>
      <td><p>tuning parameter for SCAD and MCP penalties. must be &gt;= 1</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p>mixing value for <code>sparse.grp.lasso</code>. penalty applied is (1 - tau) * (group lasso penalty) + tau * (lasso penalty)</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>A vector of describing the grouping of the coefficients. See the example below. All unpenalized variables
should be put in group 0</p></td>
    </tr>
    <tr>
      <th>penalty.factor</th>
      <td><p>Separate penalty factors can be applied to each coefficient. 
This is a number that multiplies lambda to allow differential shrinkage. Can be 0 for some variables, 
which implies no shrinkage, and that variable is always included in the model. Default is 1 for all 
variables.</p></td>
    </tr>
    <tr>
      <th>group.weights</th>
      <td><p>penalty factors applied to each group for the group lasso. Similar to <code>penalty.factor</code>, 
this is a number that multiplies lambda to allow differential shrinkage. Can be 0 for some groups, 
which implies no shrinkage, and that group is always included in the model. Default is sqrt(group size) for all
groups.</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>Logical flag for x variable standardization, prior to fitting the models. 
The coefficients are always returned on the original scale. Default is <code>standardize = TRUE</code>. If 
variables are in the same units already, you might not wish to standardize. Keep in mind that 
standardization is done differently for sparse matrices, so results (when standardized) may be
slightly different for a sparse matrix object and a dense matrix object</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>Should intercept(s) be fitted (<code>default = TRUE</code>) or set to zero (<code>FALSE</code>)</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>integer. Maximum number of OEM iterations</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>convergence tolerance for OEM iterations</p></td>
    </tr>
    <tr>
      <th>irls.maxit</th>
      <td><p>integer. Maximum number of IRLS iterations</p></td>
    </tr>
    <tr>
      <th>irls.tol</th>
      <td><p>convergence tolerance for IRLS iterations. Only used if <code>family != "gaussian"</code></p></td>
    </tr>
    <tr>
      <th>accelerate</th>
      <td><p>boolean argument. Whether or not to use Nesterov acceleration with adaptive restarting</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>Integer scalar that specifies the number of threads to be used</p></td>
    </tr>
    <tr>
      <th>compute.loss</th>
      <td><p>should the loss be computed for each estimated tuning parameter? Defaults to <code>FALSE</code>. Setting
to <code>TRUE</code> will dramatically increase computational time</p></td>
    </tr>
    <tr>
      <th>hessian.type</th>
      <td><p>only for logistic regression. if <code>hessian.type = "full"</code>, then the full hessian is used. If
<code>hessian.type = "upper.bound"</code>, then an upper bound of the hessian is used. The upper bound can be dramatically
faster in certain situations, ie when n &gt;&gt; p</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object with S3 class "oem"</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Shifeng Xiong, Bin Dai, Jared Huling, and Peter Z. G. Qian. Orthogonalizing
EM: A design-based least squares algorithm. Technometrics, 58(3):285-293, 2016. <a href='http://amstat.tandfonline.com/doi/abs/10.1080/00401706.2015.1054436'>http://amstat.tandfonline.com/doi/abs/10.1080/00401706.2015.1054436</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>n.obs</span> <span class='kw'>&lt;-</span> <span class='fl'>1e4</span>
<span class='no'>n.vars</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>

<span class='no'>true.beta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>15</span>, -<span class='fl'>0.25</span>, <span class='fl'>0.25</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='no'>n.vars</span> - <span class='fl'>15</span>))

<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n.obs</span> * <span class='no'>n.vars</span>), <span class='no'>n.obs</span>, <span class='no'>n.vars</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n.obs</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>3</span>) + <span class='no'>x</span> <span class='kw'>%*%</span> <span class='no'>true.beta</span>

<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>oem</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>,
           <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lasso"</span>, <span class='st'>"grp.lasso"</span>, <span class='st'>"sparse.grp.lasso"</span>),
           <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>5</span>))

<span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>))
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>, <span class='kw'>which.model</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: collapsing to unique 'x' values</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>, <span class='kw'>which.model</span> <span class='kw'>=</span> <span class='st'>"sparse.grp.lasso"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: collapsing to unique 'x' values</span></div><div class='img'><img src='oem-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># the oem package has support for</span>
<span class='co'># sparse design matrices</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>Matrix</span>)

<span class='no'>xs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/rsparsematrix.html'>rsparsematrix</a></span>(<span class='no'>n.obs</span> * <span class='fl'>25</span>, <span class='no'>n.vars</span> * <span class='fl'>2</span>, <span class='kw'>density</span> <span class='kw'>=</span> <span class='fl'>0.01</span>)
<span class='no'>ys</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n.obs</span> * <span class='fl'>25</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>3</span>) + <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span>(<span class='no'>xs</span> <span class='kw'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>true.beta</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='no'>n.vars</span>)) )
<span class='no'>x.dense</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>xs</span>)

<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>oem</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>x.dense</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>ys</span>,
                       <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lasso"</span>, <span class='st'>"grp.lasso"</span>),
                       <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>20</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>5</span>), <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                       <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   25.91    0.14   27.37 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>fits</span> <span class='kw'>&lt;-</span> <span class='fu'>oem</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>xs</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>ys</span>,
                        <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lasso"</span>, <span class='st'>"grp.lasso"</span>),
                        <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>20</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>5</span>), <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                        <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='no'>fit</span>$<span class='no'>lambda</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;    0.56    0.00    0.71 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>fit</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>1</span>]] - <span class='no'>fits</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>1</span>]]))</div><div class='output co'>#&gt; [1] 1.582068e-15</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>fit</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>2</span>]] - <span class='no'>fits</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>2</span>]]))</div><div class='output co'>#&gt; [1] 1.609823e-15</div><div class='input'>
<span class='co'># logistic</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n.obs</span>, <span class='fl'>1</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>1</span> / (<span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-<span class='no'>x</span> <span class='kw'>%*%</span> <span class='no'>true.beta</span>)))

<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>oem</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                       <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lasso"</span>, <span class='st'>"sparse.grp.lasso"</span>, <span class='st'>"mcp"</span>),
                       <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>,
                       <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>5</span>),
                       <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                       <span class='kw'>irls.tol</span> <span class='kw'>=</span> <span class='fl'>1e-3</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-8</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;    3.98    0.03    4.30 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>))
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>res</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>res</span>, <span class='kw'>which.model</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>res</span>, <span class='kw'>which.model</span> <span class='kw'>=</span> <span class='st'>"mcp"</span>)</div><div class='img'><img src='oem-2.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># sparse design matrix</span>
<span class='no'>xs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/rsparsematrix.html'>rsparsematrix</a></span>(<span class='no'>n.obs</span> * <span class='fl'>2</span>, <span class='no'>n.vars</span>, <span class='kw'>density</span> <span class='kw'>=</span> <span class='fl'>0.01</span>)
<span class='no'>x.dense</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>xs</span>)
<span class='no'>ys</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n.obs</span> * <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>1</span> / (<span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-<span class='no'>x</span> <span class='kw'>%*%</span> <span class='no'>true.beta</span>)))

<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>res.gr</span> <span class='kw'>&lt;-</span> <span class='fu'>oem</span>(<span class='no'>x.dense</span>, <span class='no'>ys</span>, <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                          <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='st'>"grp.lasso"</span>,
                          <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>,
                          <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                          <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>10</span>),
                          <span class='kw'>irls.tol</span> <span class='kw'>=</span> <span class='fl'>1e-3</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-8</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;    1.97    0.03    2.11 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>res.gr.s</span> <span class='kw'>&lt;-</span> <span class='fu'>oem</span>(<span class='no'>xs</span>, <span class='no'>ys</span>, <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                            <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='st'>"grp.lasso"</span>,
                            <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>,
                            <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                            <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>10</span>),
                            <span class='kw'>irls.tol</span> <span class='kw'>=</span> <span class='fl'>1e-3</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-8</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;    0.59    0.00    0.69 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>res.gr</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>1</span>]] - <span class='no'>res.gr.s</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>1</span>]]))</div><div class='output co'>#&gt; [1] 6.647085e-05</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bin Dai, Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


