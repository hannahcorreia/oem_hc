<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Orthogonalizing EM: Penalized Regression for Big Tall Data â€¢ oem</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Orthogonalizing EM: Penalized Regression for Big Tall Data">
<meta property="og:description" content="Solves penalized least squares problems for big tall data
    using the orthogonalizing EM algorithm of Xiong et al. (2016) 
    &lt;doi:10.1080/00401706.2015.1054436&gt;. The main fitting function is oem() and the
    functions cv.oem() and xval.oem() are for cross validation, the latter being an
    accelerated cross validation function for linear models. The big.oem() function
    allows for out of memory fitting.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">oem</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/oem_vignette.html">Usage of the oem Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jaredhuling/oem">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The oem package provides estimation for various penalized linear models using the <a href="http://amstat.tandfonline.com/doi/abs/10.1080/00401706.2015.1054436">Orthogonalizing EM algorithm</a>. Documentation for the package can be found here: <a href="http://jaredhuling.org/oem">oem site</a>.</p>
<p>Install using the <strong>devtools</strong> package (RcppEigen must be installed first as well):</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"jaredhuling/oem"</span>)</pre></div>
<p>or by cloning and building using <code>R CMD INSTALL</code></p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>To cite oem please use:</p>
<p>Xiong, S., Dai, B., Huling, J., Qian, P. Z. G. (2016) Orthogonalizing EM: A design-based least squares algorithm, Technometrics, Volume 58, Pages 285-293,<br><a href="http://dx.doi.org/10.1080/00401706.2015.1054436" class="uri">http://dx.doi.org/10.1080/00401706.2015.1054436</a>.</p>
<p>Huling, J.D. and Chien, P. (2018), Fast Penalized Regression and Cross Validation for Tall Data with the OEM Package, Journal of Statistical Software, to appear, URL: <a href="https://arxiv.org/abs/1801.09661" class="uri">https://arxiv.org/abs/1801.09661</a>.</p>
</div>
<div id="penalties" class="section level2">
<h2 class="hasAnchor">
<a href="#penalties" class="anchor"></a>Penalties</h2>
<div id="lasso" class="section level3">
<h3 class="hasAnchor">
<a href="#lasso" class="anchor"></a>Lasso</h3>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">microbenchmark</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">glmnet</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">oem</span>)
<span class="co"># compute the full solution path, n &gt; p</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">1000000</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">25</span>
<span class="no">b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">m</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="no">p</span> - <span class="no">m</span>)))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span> * <span class="no">p</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">3</span>), <span class="no">n</span>, <span class="no">p</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html">drop</a></span>(<span class="no">x</span> <span class="kw">%*%</span> <span class="no">b</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span>)

<span class="no">lambdas</span> <span class="kw">=</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"elastic.net"</span>)$<span class="no">lambda</span><span class="kw">[[</span><span class="fl">1</span>]]

<span class="fu">microbenchmark</span>(
    <span class="st">"glmnet[lasso]"</span> <span class="kw">=</span> {<span class="no">res1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmnet/man/glmnet.html">glmnet</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">thresh</span> <span class="kw">=</span> <span class="fl">1e-10</span>,
                                      <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                      <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                      <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">lambdas</span>)},
    <span class="st">"oem[lasso]"</span>    <span class="kw">=</span> {<span class="no">res2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>,
                                   <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"elastic.net"</span>,
                                   <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                   <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                   <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">lambdas</span>,
                                   <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)},
    <span class="kw">times</span> <span class="kw">=</span> <span class="fl">5</span>
)</pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">## Unit: seconds</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">##           expr      min       lq     mean   median       uq      max neval</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">##  glmnet[lasso] 7.610364 7.622585 7.879448 7.667767 7.945518 8.551005     5</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">##     oem[lasso] 1.969916 2.027118 2.133341 2.089135 2.126875 2.453660     5</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="r"><span class="co"># difference of results</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">res1</span>) - <span class="no">res2</span>$<span class="no">beta</span><span class="kw">[[</span><span class="fl">1</span>]]))</pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">## [1] 1.048072e-07</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">res1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmnet/man/glmnet.html">glmnet</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">thresh</span> <span class="kw">=</span> <span class="fl">1e-12</span>,
               <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
               <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
               <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">lambdas</span>)

<span class="co"># answers are now more close once we require more precise glmnet solutions</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">res1</span>) - <span class="no">res2</span>$<span class="no">beta</span><span class="kw">[[</span><span class="fl">1</span>]]))</pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">## [1] 3.763397e-09</span></span></code></pre></div>
</div>
<div id="nonconvex-penalties" class="section level3">
<h3 class="hasAnchor">
<a href="#nonconvex-penalties" class="anchor"></a>Nonconvex Penalties</h3>
<div class="sourceCode" id="cb8"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sparsenet</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ncvreg</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">plus</span>)
<span class="co"># compute the full solution path, n &gt; p</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">5000</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fl">200</span>
<span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">25</span>
<span class="no">b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">m</span>, -<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="no">p</span> - <span class="no">m</span>)))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span> * <span class="no">p</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">3</span>), <span class="no">n</span>, <span class="no">p</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html">drop</a></span>(<span class="no">x</span> <span class="kw">%*%</span> <span class="no">b</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span>)

<span class="no">mcp.lam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"mcp"</span>,
               <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
               <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
               <span class="kw">nlambda</span> <span class="kw">=</span> <span class="fl">200</span>, <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)$<span class="no">lambda</span><span class="kw">[[</span><span class="fl">1</span>]]

<span class="no">scad.lam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"scad"</span>,
               <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
               <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
               <span class="kw">nlambda</span> <span class="kw">=</span> <span class="fl">200</span>, <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)$<span class="no">lambda</span><span class="kw">[[</span><span class="fl">1</span>]]

<span class="fu">microbenchmark</span>(
    <span class="st">"sparsenet[mcp]"</span> <span class="kw">=</span> {<span class="no">res1</span> <span class="kw">&lt;-</span> <span class="fu">sparsenet</span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">thresh</span> <span class="kw">=</span> <span class="fl">1e-10</span>,
                                          <span class="kw">gamma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>), <span class="co">#sparsenet throws an error </span>
                                                          <span class="co">#if you only fit 1 value of gamma</span>
                                          <span class="kw">nlambda</span> <span class="kw">=</span> <span class="fl">200</span>)},
    <span class="st">"oem[mcp]"</span>    <span class="kw">=</span> {<span class="no">res2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>,
                                 <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"mcp"</span>,
                                 <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">2</span>,
                                 <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                 <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                 <span class="kw">nlambda</span> <span class="kw">=</span> <span class="fl">200</span>,
                                 <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)},
    <span class="st">"ncvreg[mcp]"</span>    <span class="kw">=</span> {<span class="no">res3</span> <span class="kw">&lt;-</span> <span class="fu">ncvreg</span>(<span class="no">x</span>, <span class="no">y</span>,
                                   <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"MCP"</span>,
                                   <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">2</span>,
                                   <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">mcp.lam</span>,
                                   <span class="kw">eps</span> <span class="kw">=</span> <span class="fl">1e-7</span>)},
    <span class="st">"plus[mcp]"</span>    <span class="kw">=</span> {<span class="no">res4</span> <span class="kw">&lt;-</span> <span class="fu">plus</span>(<span class="no">x</span>, <span class="no">y</span>,
                                   <span class="kw">method</span> <span class="kw">=</span> <span class="st">"mc+"</span>,
                                   <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">2</span>,
                                   <span class="kw">lam</span> <span class="kw">=</span> <span class="no">mcp.lam</span>)},
    <span class="st">"oem[scad]"</span>    <span class="kw">=</span> {<span class="no">res5</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>,
                                 <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"scad"</span>,
                                 <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">4</span>,
                                 <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                 <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                 <span class="kw">nlambda</span> <span class="kw">=</span> <span class="fl">200</span>,
                                 <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)},
    <span class="st">"ncvreg[scad]"</span>    <span class="kw">=</span> {<span class="no">res6</span> <span class="kw">&lt;-</span> <span class="fu">ncvreg</span>(<span class="no">x</span>, <span class="no">y</span>,
                                   <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"SCAD"</span>,
                                   <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">4</span>,
                                   <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">scad.lam</span>,
                                   <span class="kw">eps</span> <span class="kw">=</span> <span class="fl">1e-7</span>)},
    <span class="st">"plus[scad]"</span>    <span class="kw">=</span> {<span class="no">res7</span> <span class="kw">&lt;-</span> <span class="fu">plus</span>(<span class="no">x</span>, <span class="no">y</span>,
                                   <span class="kw">method</span> <span class="kw">=</span> <span class="st">"scad"</span>,
                                   <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">4</span>,
                                   <span class="kw">lam</span> <span class="kw">=</span> <span class="no">scad.lam</span>)},
    <span class="kw">times</span> <span class="kw">=</span> <span class="fl">5</span>
)</pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">## Unit: milliseconds</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">##            expr       min        lq      mean    median        uq      max</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">##  sparsenet[mcp] 1762.3026 1779.0533 1907.9942 1871.4751 1954.0494 2173.091</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">##        oem[mcp]  159.3148  159.6247  194.6605  160.0044  238.3018  256.057</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">##     ncvreg[mcp] 7566.5792 7636.3529 7900.8602 7681.1292 7907.0934 8713.146</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">##       plus[mcp] 1625.3785 1692.9125 1703.2951 1694.1239 1711.7150 1792.346</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">##       oem[scad]  136.1331  136.3932  138.6294  137.1140  138.2907  145.216</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">##    ncvreg[scad] 7485.8139 8060.6739 8534.4502 8388.1125 8779.2423 9958.408</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">##      plus[scad] 1765.2935 1873.8984 2009.8369 1878.5176 2097.5155 2433.959</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">diffs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>, <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">diffs</span>) <span class="kw">&lt;-</span> <span class="st">"abs diff"</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">diffs</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MCP:  oem and ncvreg"</span>, <span class="st">"SCAD: oem and ncvreg"</span>,
                     <span class="st">"MCP:  oem and plus"</span>, <span class="st">"SCAD: oem and plus"</span>)
<span class="no">diffs</span>[,<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">res2</span>$<span class="no">beta</span><span class="kw">[[</span><span class="fl">1</span>]] - <span class="no">res3</span>$<span class="no">beta</span>)), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">res5</span>$<span class="no">beta</span><span class="kw">[[</span><span class="fl">1</span>]] - <span class="no">res6</span>$<span class="no">beta</span>)),
               <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">res2</span>$<span class="no">beta</span><span class="kw">[[</span><span class="fl">1</span>]][-<span class="fl">1</span>,<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">res4</span>$<span class="no">beta</span>)] - <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">res4</span>$<span class="no">beta</span>))),
               <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">res5</span>$<span class="no">beta</span><span class="kw">[[</span><span class="fl">1</span>]][-<span class="fl">1</span>,<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">res7</span>$<span class="no">beta</span>)] - <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">res7</span>$<span class="no">beta</span>))))
<span class="no">diffs</span></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">##                          abs diff</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">## MCP:  oem and ncvreg 1.725859e-07</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">## SCAD: oem and ncvreg 5.094648e-08</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">## MCP:  oem and plus   2.684136e-11</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">## SCAD: oem and plus   1.732409e-11</span></span></code></pre></div>
</div>
<div id="group-penalties" class="section level3">
<h3 class="hasAnchor">
<a href="#group-penalties" class="anchor"></a>Group Penalties</h3>
<p>In addition to the group lasso, the oem package offers computation for the group MCP, group SCAD, and group sparse lasso penalties. All aforementioned penalties can also be augmented with a ridge penalty.</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gglasso</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">grpreg</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">grplasso</span>)
<span class="co"># compute the full solution path, n &gt; p</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">10000</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fl">200</span>
<span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">25</span>
<span class="no">b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">m</span>, -<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="no">p</span> - <span class="no">m</span>)))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span> * <span class="no">p</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">3</span>), <span class="no">n</span>, <span class="no">p</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html">drop</a></span>(<span class="no">x</span> <span class="kw">%*%</span> <span class="no">b</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span>)
<span class="no">groups</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(<span class="no">p</span>/<span class="fl">10</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">10</span>)

<span class="no">grp.lam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"grp.lasso"</span>,
               <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>,
               <span class="kw">nlambda</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)$<span class="no">lambda</span><span class="kw">[[</span><span class="fl">1</span>]]


<span class="fu">microbenchmark</span>(
    <span class="st">"gglasso[grp.lasso]"</span> <span class="kw">=</span> {<span class="no">res1</span> <span class="kw">&lt;-</span> <span class="fu">gglasso</span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">groups</span>,
                                            <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">grp.lam</span>,
                                            <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                            <span class="kw">eps</span> <span class="kw">=</span> <span class="fl">1e-8</span>)},
    <span class="st">"oem[grp.lasso]"</span>    <span class="kw">=</span> {<span class="no">res2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>,
                                       <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>,
                                       <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                       <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                       <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"grp.lasso"</span>,
                                       <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">grp.lam</span>,
                                       <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)},
    <span class="st">"grplasso[grp.lasso]"</span>    <span class="kw">=</span> {<span class="no">res3</span> <span class="kw">&lt;-</span> <span class="fu">grplasso</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">y</span>,
                                                 <span class="kw">index</span> <span class="kw">=</span> <span class="no">groups</span>,
                                                 <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                                 <span class="kw">center</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="fu">LinReg</span>(),
                                                 <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">grp.lam</span> * <span class="no">n</span> * <span class="fl">2</span>,
                                                 <span class="kw">control</span> <span class="kw">=</span> <span class="fu">grpl.control</span>(<span class="kw">trace</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>))},
    <span class="st">"grpreg[grp.lasso]"</span>    <span class="kw">=</span> {<span class="no">res4</span> <span class="kw">&lt;-</span> <span class="fu">grpreg</span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">groups</span>,
                                             <span class="kw">eps</span> <span class="kw">=</span> <span class="fl">1e-10</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">grp.lam</span>)},
    <span class="kw">times</span> <span class="kw">=</span> <span class="fl">5</span>
)</pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">## Unit: milliseconds</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">##                 expr        min       lq      mean    median        uq</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">##   gglasso[grp.lasso] 3483.62353 3529.320 3601.1492 3600.3122 3675.7521</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">##       oem[grp.lasso]   99.62382  100.823  107.9303  106.6158  114.8208</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">##  grplasso[grp.lasso] 7105.62106 7409.959 7835.5972 7836.2535 7977.5347</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">##    grpreg[grp.lasso] 1972.84562 2013.477 2132.7026 2015.0525 2149.0820</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">##        max neval</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">##  3716.7380     5</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">##   117.7679     5</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">##  8848.6178     5</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">##  2513.0563     5</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="r"><span class="no">diffs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>, <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">diffs</span>) <span class="kw">&lt;-</span> <span class="st">"abs diff"</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">diffs</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"oem and gglasso"</span>, <span class="st">"oem and grplasso"</span>)
<span class="no">diffs</span>[,<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">res2</span>$<span class="no">beta</span><span class="kw">[[</span><span class="fl">1</span>]][-<span class="fl">1</span>,] - <span class="no">res1</span>$<span class="no">beta</span>)), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">res2</span>$<span class="no">beta</span><span class="kw">[[</span><span class="fl">1</span>]][-<span class="fl">1</span>,] - <span class="no">res3</span>$<span class="no">coefficients</span>))  )
<span class="no">diffs</span></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">##                      abs diff</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">## oem and gglasso  1.303906e-06</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">## oem and grplasso 1.645871e-08</span></span></code></pre></div>
<div id="bigger-group-lasso-example" class="section level4">
<h4 class="hasAnchor">
<a href="#bigger-group-lasso-example" class="anchor"></a>Bigger Group Lasso Example</h4>
<div class="sourceCode" id="cb16"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">500000</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fl">200</span>
<span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">25</span>
<span class="no">b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">m</span>, -<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="no">p</span> - <span class="no">m</span>)))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span> * <span class="no">p</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">3</span>), <span class="no">n</span>, <span class="no">p</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html">drop</a></span>(<span class="no">x</span> <span class="kw">%*%</span> <span class="no">b</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span>)
<span class="no">groups</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(<span class="no">p</span>/<span class="fl">10</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">10</span>)

<span class="co"># fit all group penalties at once</span>
<span class="no">grp.penalties</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"grp.lasso"</span>, <span class="st">"grp.mcp"</span>, <span class="st">"grp.scad"</span>,
                   <span class="st">"grp.mcp.net"</span>, <span class="st">"grp.scad.net"</span>,
                   <span class="st">"sparse.group.lasso"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>,
                       <span class="kw">penalty</span> <span class="kw">=</span> <span class="no">grp.penalties</span>,
                       <span class="kw">groups</span>  <span class="kw">=</span> <span class="no">groups</span>,
                       <span class="kw">alpha</span>   <span class="kw">=</span> <span class="fl">0.25</span>, <span class="co"># mixing param for l2 penalties</span>
                       <span class="kw">tau</span>     <span class="kw">=</span> <span class="fl">0.5</span>)) <span class="co"># mixing param for sparse grp lasso </span></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">##    user  system elapsed </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">##    3.23    0.17    3.46</span></span></code></pre></div>
</div>
</div>
<div id="fitting-multiple-penalties" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-multiple-penalties" class="anchor"></a>Fitting Multiple Penalties</h3>
<p>The oem algorithm is quite efficient at fitting multiple penalties simultaneously when p is not too big.</p>
<div class="sourceCode" id="cb18"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">100000</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">15</span>
<span class="no">b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">m</span>, -<span class="fl">0.25</span>, <span class="fl">0.25</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="no">p</span> - <span class="no">m</span>)))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span> * <span class="no">p</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">3</span>), <span class="no">n</span>, <span class="no">p</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html">drop</a></span>(<span class="no">x</span> <span class="kw">%*%</span> <span class="no">b</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span>)

<span class="fu">microbenchmark</span>(
    <span class="st">"oem[lasso]"</span>    <span class="kw">=</span> {<span class="no">res1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>,
                                   <span class="kw">penalty</span> <span class="kw">=</span> <span class="st">"elastic.net"</span>,
                                   <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                   <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                   <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)},
    <span class="st">"oem[lasso/mcp/scad/ols]"</span>    <span class="kw">=</span> {<span class="no">res2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/oem.html">oem</a></span>(<span class="no">x</span>, <span class="no">y</span>,
                                   <span class="kw">penalty</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"elastic.net"</span>, <span class="st">"mcp"</span>,
                                               <span class="st">"scad"</span>, <span class="st">"grp.lasso"</span>,
                                               <span class="st">"grp.mcp"</span>, <span class="st">"sparse.grp.lasso"</span>,
                                               <span class="st">"grp.mcp.net"</span>, <span class="st">"mcp.net"</span>),
                                   <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">4</span>,
                                   <span class="kw">tau</span> <span class="kw">=</span> <span class="fl">0.5</span>,
                                   <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.25</span>,
                                   <span class="kw">groups</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">10</span>),
                                   <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                   <span class="kw">standardize</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                   <span class="kw">tol</span> <span class="kw">=</span> <span class="fl">1e-10</span>)},
    <span class="kw">times</span> <span class="kw">=</span> <span class="fl">5</span>
)</pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">## Unit: milliseconds</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">##                     expr      min       lq     mean   median       uq</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">##               oem[lasso] 214.3171 218.2459 225.8759 219.6271 226.8682</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">##  oem[lasso/mcp/scad/ols] 253.8738 255.8601 279.3674 272.4458 276.6489</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">##       max neval</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">##  250.3211     5</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">##  338.0085     5</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="r"><span class="co">#png("../mcp_path.png", width = 3000, height = 3000, res = 400);par(mar=c(5.1,5.1,4.1,2.1));plot(res2, which.model = 2, main = "mcp",lwd = 3,cex.axis=2.0, cex.lab=2.0, cex.main=2.0, cex.sub=2.0);dev.off()</span>
<span class="co">#</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">1</span>:<span class="fl">4</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">res2</span>, <span class="kw">which.model</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>,
     <span class="kw">xvar</span> <span class="kw">=</span> <span class="st">"lambda"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">res2</span>, <span class="kw">which.model</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>,
     <span class="kw">xvar</span> <span class="kw">=</span> <span class="st">"lambda"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">res2</span>, <span class="kw">which.model</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>,
     <span class="kw">xvar</span> <span class="kw">=</span> <span class="st">"lambda"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">res2</span>, <span class="kw">which.model</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>,
     <span class="kw">xvar</span> <span class="kw">=</span> <span class="st">"lambda"</span>)</pre></div>
<p><img src="articles/mult-1.png" style="display: block; margin: auto;"></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=oem">https://â€‹cloud.r-project.org/â€‹package=oem</a>
</li>
<li>Browse source code at <br><a href="https://github.com/jaredhuling/oem/">https://â€‹github.com/â€‹jaredhuling/â€‹oem/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/jaredhuling/oem/issues">https://â€‹github.com/â€‹jaredhuling/â€‹oem/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing oem</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Bin Dai <br><small class="roles"> Author </small>  </li>
<li>Jared Huling <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-0670-4845" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=oem"><img src="http://www.r-pkg.org/badges/version/oem" alt="version"></a></li>
<li><a href="https://travis-ci.org/jaredhuling/oem"><img src="https://travis-ci.org/jaredhuling/oem.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/jaredhuling/oem"><img src="https://ci.appveyor.com/api/projects/status/github/jaredhuling/oem?branch=master&amp;svg=true" alt="Appveyor Build Status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Bin Dai, Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
